{% extends "manage.html" %}
{% load thumbnail %}
{% block script %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
{% endblock %}
{% block pagetitle %}Question Statistics for {{ quiz.description }}{% endblock pagetitle %}

{% block content %}
<div class="row">
    <div class="col-md-2">
{% for attempt in attempts %}
    <p><a href="{{URL_ROOT}}/exam/manage/statistics/question/{{questionpaper_id}}/{{attempt}}">Attempt {{ attempt }}</a></p>
    {% endfor %}
</div>

{% if question_stats %}
    <p></p>
    <p><b>Total number of participants: 79</b></p>
    <p><b>Time: {{quiz.start_date_time}}<b><p>
    <table class="table table-bordered">
        <tr><th>Sr. No. </th><th>Question</th><th>Type</th><th>Total</th><th>Right Answered</th><th>Wrong Answered</th><th>Unanswered/<br/>Skipped</th><th>Graph</th></tr>
        {% for question, value in question_stats.items  %}
        <tr><td>{{forloop.counter}}</td>
        <td><img alt="Question" src="{{ question.picture.url }}" class="img-responsive"></td>
        <td>{{ question.type }}</td><td>{{value.1}}</td>
        <td>{{ value.0 }} ({% widthratio value.0 value.1 100 %}%)</td>
        <td>{{ value.3 }} ({% widthratio value.3 value.1 100 %}%)</td>
        <td>{{ value.2 }} ({% widthratio value.2 value.1 100 %}%)</td>
        <td id={{question.id}}><script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        var data = google.visualization.arrayToDataTable([
          ['Answers', 'Numbers'],
          ['Skipped', {{value.2}}],
          ['Wrong Answered', {{value.3}}],
          
          ['Right Answered', {{value.0}}]
        ]);
        
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Topping');
        data.addColumn('number', 'Slices');
        data.addRows([
          ['Skipped', {{value.2}}],
          ['Wrong Answered', {{value.3}}],
          
          ['Right Answered', {{value.0}}]
        ]);

        // Set chart options
        var options = { legend: 'none',
                        is3D: true,
                       'width':200,
                       'height':100};

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById({{question.id}}));
        chart.draw(data, options);
      }
    </script> </td></tr>
        
        {% endfor %}
    </table>
    {% endif %}
    
</div>
{% endblock %}
